{
  "hash": "ad53835b2c1fba8ea24bddbc0f38a4cd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Placing silhouettes in base r plots using rphylopic\"\nimage: rphylopic.png\nauthor: \"Gabriela Palomo-Munoz\"\ndate: \"2023-04-09\"\ncategories: [baser, rphylopic, silhouettes]\n# draft: true\n---\n\n\n## The rphylopic package\n\nI explained a little of what phylopic and the rphylopic package are [here](https://gabspalomo.github.io/blog/rphylopic_ggplot2/). I wanted to continue this series with explaining how to use this versatile package but this time in base r.\n\n## Basic plot in base r\n\nWe will use again the tree dataset and plot a simple linear model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Let's call the data trees available in the dataset package\ndata(trees)\n## Let's see the names of the variables\nnames(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Girth\"  \"Height\" \"Volume\"\n```\n\n\n:::\n\n```{.r .cell-code}\n## Let's rename the variable 'girth' to 'dbh' \n## which stands for diameter at breast height\nnames(trees) <- c('dbh', 'Height', 'Volume')\n## Let's check that it worked \nnames(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"dbh\"    \"Height\" \"Volume\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Let's do the model first\nm <- lm(dbh ~ Height, data = trees)\n## We have to predict some values to estimate the confidence intervals\nnd <- seq(min(trees$Height), max(trees$Height), length.out=100)\npred <- predict(m, newdata = data.frame(Height=nd), interval = 'confidence')\n## Let's make a new data frame with our x, predicted y, and conf.int.\nnd <- data.frame(cbind(nd, pred))\n\n## Now the basic scatter plot \nplot(dbh ~ Height, data = trees)\n## Now let's add the fitted line from the lm model\nabline(m)\n## Let's add some lines for our confidence intervals \nlines(nd$nd, nd$lwr, lty = 'dashed', col = 'gray70')\nlines(nd$nd, nd$upr, lty = 'dashed', col = 'gray70')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Customizing the base plot\n\nNow that we have the basic plot, let's customize it a little bit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now the basic scatter plot \nplot(dbh ~ Height, data = trees,\n     xlab = 'Height', \n     ylab = 'DBH',\n     font.lab = 14, # x and y labels Using font 14 which is \n     font.axis = 14,\n     ylim=c(0,20),\n     pch = 20)\ntitle(main = \"Graph in base r\",\n     adj = 0,\n     font.main = 15, # main title font 14 which is in bold\n     cex.main = 2) # font size of main title)\ntitle(sub = \"Source: trees\",\n      font.sub = 14,\n      cex.sub = 0.75,\n      adj = 1,)\n## I want shaded confidence intervals so for that we will use \n## the function polygon()\npolygon(c(nd$nd, rev(nd$nd)),\n        c(nd$lwr,rev(nd$upr)),\n        col=adjustcolor('dodgerblue', alpha=0.1),\n        border=NA)\n## Now let's add the fitted line from the lm model\nabline(m, col = \"#00688B\",  lwd = 2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Now let's add a silhouette to this plot\n\nTo add a silhouette to a base plot you can do it three ways using the add_phylopic_base() function: \n\n1. by calling the uuid directly: add_phylopic_base(uuid=uuid). Remember that you can always check the uuid for any silhouette by first running the function get_uuid(name = 'genus species'). \n\n2. by calling the species name: add_phylopic_base(name='genus species'), or \n\n3. by loading a saved image in your working directory: add_phylopic_base(img=img)\n\n:::{.callout-tip title='Visualize silhouettes in the viewer' collapse=TRUE eval=FALSE}\nIf you are using RStudio, then you can visualize the silhouettes for any species -or whatever taxonomic category- in the viewer. This is especially useful for species that have multiple silhouettes. \n\npick_phylopic(name = 'Canis lupus')\n\nAnd type 1 in the console to change to the following silhouettes. \n\nOnce you picked a specific silhouette, then you can do the following which will save the uuid to 'sil'.\n\nsil <- pick_phylopic(name = 'Canis lupus', n=1)\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## First we load the rphylopic package \n# install.packages('rphylopic')\nlibrary(rphylopic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nYou are using rphylopic v.1.3.0. Please remember to credit PhyloPic contributors (hint: `get_attribution()`) and cite rphylopic in your work (hint: `citation(\"rphylopic\")`).\n```\n\n\n:::\n\n```{.r .cell-code}\n## Then we make the plot \n## Now the basic scatter plot \nplot(dbh ~ Height, data = trees,\n     xlab = 'Height', \n     ylab = 'DBH',\n     font.lab = 14, # x and y labels Using font 14 which I think is Century Gothic. \n     font.axis = 14,\n     ylim=c(0,20),\n     pch = 20)\ntitle(main = \"Graph in base r\",\n     adj = 0,\n     font.main = 15, # main title font family 15 is 14 in bold\n     cex.main = 2) # font size of main title)\ntitle(sub = \"Source: trees\",\n      font.sub = 14,\n      cex.sub = 0.75,\n      adj = 1,)\n## I want shaded confidence intervals so for that we will use \n## the function polygon()\npolygon(c(nd$nd, rev(nd$nd)),\n        c(nd$lwr,rev(nd$upr)),\n        col=adjustcolor('dodgerblue', alpha=0.1),\n        border=NA)\n## Now let's add the fitted line from the lm model\nabline(m, col = \"#00688B\",  lwd = 2)\n\n## Now we add the silhouette! \nadd_phylopic_base(name = 'Cornus florida', \n                  x = 85, \n                  y = 5,  \n                  ysize = 7) # This is in the same scale as your y-axis\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: You've used the `name` argument. You may want to use `verbose = TRUE`\nto get attribution information for the silhouette(s).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThe **key** thing to keep in mind is that what guides the position and size of the silhouette inside the plot is the scale you are using in that plot. In this case, the size I chose for the silhouette ysize=7 is in relation to the y-axis scale, which in this case is 7 units in y-axis. The position corresponds with the x- and y-axis coordinates. See how the center of the silhouette is at x=85 and y=5.  \n\n## What if you want the silhouette outside the plot\n\nJust try negative values for x and y. That will help you position it outside the plot area, for example next to the legend. For example, try the plot above but using x=85 and y = -5\n\n\n## Don't forget the attribution!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuuid <- get_uuid(name = \"Cornus florida\")\n# Get attribution data for uuid\nat <- get_attribution(uuid = uuid)\nat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$contributor\n[1] \"Gabriela Palomo-Munoz\"\n\n$contributor_uuid\n[1] \"f57cf3c4-210c-4bcf-a759-9fcbc0cd8ba1\"\n\n$created\n[1] \"2022-08-13\"\n\n$contact\n[1] \"gabriella.palomo@gmail.com\"\n\n$image_uuid\n[1] \"8b16a223-4e27-4ce5-83a4-904b86287d49\"\n\n$license\n[1] \"https://creativecommons.org/licenses/by/4.0/\"\n\n$license_abbr\n[1] \"CC BY 4.0\"\n```\n\n\n:::\n:::\n\n\n## Final plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## First we load the rphylopic package \n# install.packages('rphylopic')\nlibrary(rphylopic)\n\n## Then we make the plot \n## Now the basic scatter plot \nplot(dbh ~ Height, data = trees,\n     xlab = 'Height', \n     ylab = 'DBH',\n     font.lab = 14, # x and y labels Using font 14 which is \n     font.axis = 14,\n     ylim=c(0,20),\n     pch = 20)\ntitle(main = \"Graph in base r\",\n     adj = 0,\n     font.main = 15, # main title font 14 which is in bold\n     cex.main = 2) # font size of main title)\ntitle(sub = paste0(\"Source: trees\", \"; silhouette by:\" , at$contributor), # at is the attribution of the silhouette \n      font.sub = 14,\n      cex.sub = 0.75,\n      adj = 1,)\n## I want shaded confidence intervals so for that we will use \n## the function polygon()\npolygon(c(nd$nd, rev(nd$nd)),\n        c(nd$lwr,rev(nd$upr)),\n        col=adjustcolor('dodgerblue', alpha=0.1),\n        border=NA)\n## Now let's add the fitted line from the lm model\nabline(m, col = \"#00688B\",  lwd = 2)\n\n## Now we add the silhouette! \nadd_phylopic_base(name = 'Cornus florida', \n                  x = 85, \n                  y = 5,  \n                  ysize = 7) # This is in the same scale as your y-axis\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: You've used the `name` argument. You may want to use `verbose = TRUE`\nto get attribution information for the silhouette(s).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Cite rphylopic in your manuscript or work:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncitation('rphylopic')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nTo cite rphylopic in publications, use the following citation:\n\n  Gearty, W. and Jones, L.A. 2023. rphylopic: An R package for\n  fetching, transforming, and visualising PhyloPic silhouettes. Methods\n  in Ecology and Evolution, 14(11), 2700-2708. doi:\n  10.1111/2041-210X.14221.\n\nA BibTeX entry for LaTeX users is\n\n  @Article{,\n    title = {rphylopic: An R package for fetching, transforming, and visualising PhyloPic silhouettes},\n    author = {William Gearty and Lewis A. Jones},\n    year = {2023},\n    volume = {14},\n    number = {11},\n    pages = {2700-2708},\n    journal = {Methods in Ecology and Evolution},\n    doi = {10.1111/2041-210X.14221},\n  }\n```\n\n\n:::\n:::\n\n\nAnd that's it, that's all I have for you. If you have any questions don't hesitate to [contact me](https://gabspalomo.github.io/).\n\n[Gabby]{style=\"color:deepskyblue4;font-size:40px;\"} \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}